webpackJsonp([7],{ldVO:function(e,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var r={data:function(){return{form:{ys:"",cm:"",jdsl:""},forms:{id:"",yss:"",cms:"",jdsls:""},loading:!1,scaleClass:"",dialogFormVisible:!1,dialogFormCmYsSlVisible:!1,rules:{cms:[{required:!0,message:"请输入尺码",trigger:"blur"}],yss:[{required:!0,message:"请输入商品颜色",trigger:"blur"}],jdsls:[{required:!0,message:"请输入商品数量",trigger:"blur"}],ys:[{required:!0,message:"请输入商品颜色",trigger:"blur"}],jdsl:[{required:!0,message:"请输入商品数量",trigger:"blur"}],spmc:[{required:!0,message:"请输入商品名称",trigger:"blur"}],itemno:[{required:!0,message:"请输入采购编码",trigger:"blur"}],dw:[{required:!0,message:"请选择采购单位",trigger:"blur"}],lbid:[{required:!0,message:"请选择商品类别",trigger:"blur"}],cz:[{required:!0,message:"请输入材质",trigger:"blur"}],costprice:[{required:!0,message:"请录入价格",trigger:"blur"}]},ruleForm:{spmc:"",itemno:"",dw:"",spcode:"",lbid:"",lbidArr:[],lbmc:"",cz:"",brand:"",costprice:"",productdesc:"",dws:[],lboptions:[],cms:[],tableData:[]}}},created:function(){var e=this;this.$api.page("productlb/getProductLbPageList",{},localStorage.token,function(l){var t=new Array;t.length=0;for(var r=0;r<l[0].children.length;r++){var o=new Array;if(o.length=0,l[0].children[r].children.length>0){for(var a=0;a<l[0].children[r].children.length;a++)o.push({value:l[0].children[r].children[a].id,label:l[0].children[r].children[a].text});t.push({value:l[0].children[r].id,label:l[0].children[r].text,children:o})}else t.push({value:l[0].children[r].id,label:l[0].children[r].text})}e.ruleForm.lboptions=t},function(e){console.log("获取类别列表失败")}),this.$api.get("product/getAutoCreateCgItemno",{},localStorage.token,function(l){e.ruleForm.itemno=l.obj},function(e){console.log("获取采购编码失败")}),this.$api.page("dw/getErpDwList",{},localStorage.token,function(l){var t=new Array;t.length=0;for(var r=0;r<l.length;r++)t.push({value:l[r].dwmc,label:l[r].dwmc});e.ruleForm.dws=t},function(e){console.log("获取单位列表失败")}),this.$api.page("sizeinfo/getSizeinfos",{},localStorage.token,function(l){var t=new Array;t.length=0;for(var r=0;r<l.length;r++)t.push({value:l[r].cmmc,label:l[r].cmmc});e.ruleForm.cms=t},function(e){console.log("获取尺码列表失败")})},mounted:function(){this.scaleClass="scaleClass"},methods:{submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(l){l?(e.loading=!0,0==e.ruleForm.tableData.length?(e.loading=!1,e.$message({message:"表单填写不完整，请检查是否填写详情信息",duration:"2500",type:"warning"})):e.$api.put("product/addProductInfo",{spmc:e.ruleForm.spmc,spcode:e.ruleForm.spcode,dw:e.ruleForm.dw,lbid:e.ruleForm.lbid,lbmc:e.ruleForm.lbmc,cz:e.ruleForm.cz,brand:e.ruleForm.brand,costprice:e.ruleForm.costprice,productdesc:e.ruleForm.productdesc,itemno:e.ruleForm.itemno,erpSpmxes:e.ruleForm.tableData},localStorage.token,function(l){e.$message({message:l.msg,duration:"1000",type:"success"}),e.$router.push({path:"/nav/sptb/sptb"})},function(l){e.loading=!1,e.$message({message:l.msg,duration:"1000",type:"error"})})):e.$message({message:"表单填写不完整，请检查基本信息是否填写完整",duration:"2500",type:"warning"})})},gotoParentPage:function(){this.$router.push({path:"/nav/sptb/sptb"})},handleChangelb:function(){var e=this;this.$api.page("product/getProductCodeByLbid/"+this.ruleForm.lbidArr[1],{},localStorage.token,function(l){e.ruleForm.spcode=l.obj;for(var t=0;t<e.ruleForm.lboptions.length;t++)for(var r=0;r<e.ruleForm.lboptions[t].children.length;r++)e.ruleForm.lboptions[t].children[r].value==e.ruleForm.lbidArr[1]&&(e.ruleForm.lbmc=e.ruleForm.lboptions[t].children[r].label,e.ruleForm.lbid=e.ruleForm.lbidArr[1])},function(e){console.log("获取商品编码失败")})},handleCmYsSl:function(){this.form.cm?(this.form.ys="",this.form.jdsl="",this.dialogFormVisible=!0):this.$message({message:"请选择尺码",type:"warning"})},addYsSl:function(){var e=this;this.$refs.form.validate(function(l){if(l){var t=!1,r=0;if(e.ruleForm.tableData.length>0){for(var o=0;o<e.ruleForm.tableData.length;o++)e.form.cm==e.ruleForm.tableData[o].cm&&e.form.ys==e.ruleForm.tableData[o].ys&&(t=!0,r=o);t?e.$confirm("所要添加的尺码+颜色在列表中已经存在","Warning",{confirmButtonText:"覆盖",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.ruleForm.tableData[r].jdsl=parseInt(e.ruleForm.tableData[r].jdsl)+parseInt(e.form.jdsl),e.dialogFormVisible=!1}).catch(function(){e.dialogFormVisible=!1}):(e.ruleForm.tableData.push({id:e.ruleForm.tableData.length,cm:e.form.cm,jdsl:e.form.jdsl,ys:e.form.ys}),e.dialogFormVisible=!1)}else e.ruleForm.tableData.push({id:e.ruleForm.tableData.length,cm:e.form.cm,jdsl:e.form.jdsl,ys:e.form.ys}),e.dialogFormVisible=!1}})},updCmYsSl:function(e){this.dialogFormCmYsSlVisible=!0;for(var l=0;l<this.ruleForm.tableData.length;l++)this.ruleForm.tableData[l].id==e&&(this.forms.id=this.ruleForm.tableData[l].id,this.forms.cms=this.ruleForm.tableData[l].cm,this.forms.yss=this.ruleForm.tableData[l].ys,this.forms.jdsls=this.ruleForm.tableData[l].jdsl)},updateCmYsSl:function(e){var l=this;this.$refs.forms.validate(function(t){if(t){l.dialogFormCmYsSlVisible=!1;for(var r=0;r<l.ruleForm.tableData.length;r++)l.ruleForm.tableData[r].id==e&&(l.ruleForm.tableData[r].cm=l.forms.cms,l.ruleForm.tableData[r].ys=l.forms.yss,l.ruleForm.tableData[r].jdsl=l.forms.jdsls)}})},delteleCmYsSl:function(e){for(var l=0;l<this.ruleForm.tableData.length;l++)this.ruleForm.tableData[l].id==e&&this.ruleForm.tableData.splice(e,1);for(var t=0;t<this.ruleForm.tableData.length;t++)this.ruleForm.tableData[t].id=t}}},o={render:function(){var e=this,l=e.$createElement,t=e._self._c||l;return t("div",{class:e.scaleClass},[e._m(0),e._v(" "),t("el-form",{ref:"ruleForm",staticStyle:{"text-align":"left"},attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-tabs",{attrs:{"tab-position":"right"}},[t("el-tab-pane",{attrs:{label:"基本信息"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"spmc"}},[t("el-input",{attrs:{type:"text",placeholder:"商品名称",clearable:"",maxlength:"60",autocomplete:"off"},model:{value:e.ruleForm.spmc,callback:function(l){e.$set(e.ruleForm,"spmc",l)},expression:"ruleForm.spmc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"采购编码",prop:"itemno"}},[t("el-input",{attrs:{type:"text",placeholder:"采购编码",clearable:"",maxlength:"40",autocomplete:"off",disabled:!0},model:{value:e.ruleForm.itemno,callback:function(l){e.$set(e.ruleForm,"itemno",l)},expression:"ruleForm.itemno"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"单位",prop:"dw"}},[t("el-select",{attrs:{placeholder:"单位",clearable:"",filterable:""},model:{value:e.ruleForm.dw,callback:function(l){e.$set(e.ruleForm,"dw",l)},expression:"ruleForm.dw"}},e._l(e.ruleForm.dws,function(e){return t("el-option",{attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"款号",prop:"spcode"}},[t("el-input",{attrs:{type:"text",disabled:!0},model:{value:e.ruleForm.spcode,callback:function(l){e.$set(e.ruleForm,"spcode",l)},expression:"ruleForm.spcode"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品类别",prop:"lbid"}},[t("el-cascader",{attrs:{filterable:"","show-all-levels":!1,"expand-trigger":"hover",options:e.ruleForm.lboptions},on:{change:e.handleChangelb},model:{value:e.ruleForm.lbidArr,callback:function(l){e.$set(e.ruleForm,"lbidArr",l)},expression:"ruleForm.lbidArr"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"材质",prop:"cz"}},[t("el-input",{attrs:{type:"text",placeholder:"材质",clearable:"",maxlength:"20",autocomplete:"off"},model:{value:e.ruleForm.cz,callback:function(l){e.$set(e.ruleForm,"cz",l)},expression:"ruleForm.cz"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[t("el-input",{attrs:{type:"text",placeholder:"品牌",clearable:"",maxlength:"20",autocomplete:"off"},model:{value:e.ruleForm.brand,callback:function(l){e.$set(e.ruleForm,"brand",l)},expression:"ruleForm.brand"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"价格",prop:"costprice"}},[t("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.ruleForm.costprice,callback:function(l){e.$set(e.ruleForm,"costprice",l)},expression:"ruleForm.costprice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品描述",prop:"productdesc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.productdesc,callback:function(l){e.$set(e.ruleForm,"productdesc",l)},expression:"ruleForm.productdesc"}})],1)],1),e._v(" "),t("el-tab-pane",{attrs:{label:"详情"}},[t("el-form-item",{attrs:{prop:"cm"}},[t("el-select",{attrs:{placeholder:"尺码",clearable:"",filterable:""},model:{value:e.form.cm,callback:function(l){e.$set(e.form,"cm",l)},expression:"form.cm"}},e._l(e.ruleForm.cms,function(e){return t("el-option",{attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.handleCmYsSl}},[e._v("添加")])],1),e._v(" "),t("el-form-item",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ruleForm.tableData}},[t("el-table-column",{attrs:{prop:"cm",label:"尺码"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ys",label:"颜色"}}),e._v(" "),t("el-table-column",{attrs:{prop:"jdsl",label:"数量"}}),e._v(" "),t("el-table-column",{attrs:{prop:"id",fixed:"right",label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-row",[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-edit"},nativeOn:{click:function(t){t.preventDefault(),e.updCmYsSl(l.row.id)}}},[e._v("修改")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},nativeOn:{click:function(t){t.preventDefault(),e.delteleCmYsSl(l.row.id)}}},[e._v("删除")])],1)]}}])})],1)],1)],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(l){return l.preventDefault(),e.submitForm(l)}}},[e._v("提交")]),e._v(" "),t("el-button",{nativeOn:{click:function(l){return l.preventDefault(),e.gotoParentPage(l)}}},[e._v("返回")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"指定颜色数量",visible:e.dialogFormVisible,width:"400px"},on:{"update:visible":function(l){e.dialogFormVisible=l}}},[t("el-form",{ref:"form",staticStyle:{"text-align":"left"},attrs:{model:e.form,rules:e.rules,"label-width":"60px"}},[t("el-form-item",{attrs:{label:"颜色",prop:"ys"}},[t("el-input",{attrs:{autocomplete:"off",clearable:""},model:{value:e.form.ys,callback:function(l){e.$set(e.form,"ys",l)},expression:"form.ys"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数量",prop:"jdsl"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.form.jdsl,callback:function(l){e.$set(e.form,"jdsl",l)},expression:"form.jdsl"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(l){l.preventDefault(),e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(l){return l.preventDefault(),e.addYsSl(l)}}},[e._v("确定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"修改尺码颜色数量",visible:e.dialogFormCmYsSlVisible,width:"400px"},on:{"update:visible":function(l){e.dialogFormCmYsSlVisible=l}}},[t("el-form",{ref:"forms",staticStyle:{"text-align":"left"},attrs:{model:e.forms,rules:e.rules,"label-width":"60px"}},[t("el-form-item",{attrs:{label:"尺码",prop:"cms"}},[t("el-select",{attrs:{placeholder:"尺码",clearable:"",filterable:""},model:{value:e.forms.cms,callback:function(l){e.$set(e.forms,"cms",l)},expression:"forms.cms"}},e._l(e.ruleForm.cms,function(e){return t("el-option",{attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"颜色",prop:"yss"}},[t("el-input",{attrs:{autocomplete:"off",clearable:""},model:{value:e.forms.yss,callback:function(l){e.$set(e.forms,"yss",l)},expression:"forms.yss"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数量",prop:"jdsls"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.forms.jdsls,callback:function(l){e.$set(e.forms,"jdsls",l)},expression:"forms.jdsls"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(l){l.preventDefault(),e.dialogFormCmYsSlVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(l){l.preventDefault(),e.updateCmYsSl(e.forms.id)}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,l=this._self._c||e;return l("div",{staticClass:"tip"},[l("p",[this._v("温馨提醒：表单界面右侧有选项卡，必须将基本信息和详情填写完毕才可以提交表单")])])}]};var a=t("VU/8")(r,o,!1,function(e){t("w0gE")},"data-v-69f287c0",null);l.default=a.exports},w0gE:function(e,l){}});
//# sourceMappingURL=7.1f113e26b7eade25cd0e.js.map